<!DOCTYPE html>
<html>
    <head>
        <link rel='stylesheet' href='/components/bootstrap/dist/css/bootstrap.css' />
        <link rel='stylesheet' href='/stylesheets/style.css' />
        <link rel='stylesheet' href='/stylesheets/hand.css' />

        <script src='/components/zepto/zepto.js'></script>
        <script>
            // quick fix for jquery hammerjs plugin
            jQuery = Zepto;
        </script>

        <script src="/socket.io/socket.io.js"></script>
        <script src="/components/hammerjs/hammer.js"></script>
        <script src="/components/jquery-hammerjs/jquery.hammer.js"></script>

        <script>
            $(function() {
                var socket = io.connect('http://localhost:3000');
                socket.on('news', function (data) {
                    console.log(data);
                    //socket.emit('my other event', { my: 'data' });
                });

                $('#test-button').on('click', function(event) {
                    socket.emit('button', { page: 'hand' });
                });

                var cards = document.getElementsByClassName('card');
                Array.prototype.forEach.call(cards, function (card) {

                    var hammer = new Hammer(card, {});

                    //hammer.get('pan').set({ enable: false });
                    hammer.get('pan').set({ direction: Hammer.DIRECTION_VERTICAL });
                    hammer.get('swipe').set({ enable: false });
                    hammer.get('pinch').set({ enable: false });
                    hammer.get('rotate').set({ enable: false });

                    hammer.on('tap', function(ev) {
                        socket.emit('card-tapped', { id: card.id });
                    });
                    hammer.on('panup', function(ev) {
                        var transform = 'translateY(' + ev.deltaY + 'px)';
                        card.style.transform = transform;
                        card.style.oTransform = transform;
                        card.style.msTransform = transform;
                        card.style.mozTransform = transform;
                        card.style.webkitTransform = transform;
                        console.log('up ' + card.id);
                    });
                    hammer.on('pandown', function(ev) {
                        var transform = 'translateY(-' + ev.deltaY + 'px)';
                        card.style.transform = transform;
                        card.style.oTransform = transform;
                        card.style.msTransform = transform;
                        card.style.mozTransform = transform;
                        card.style.webkitTransform = transform;
                        console.log('down ' + card.id);
                    });
                    /*hammer.on('panleft', function(ev) {
                        console.log('left ' + card.id);
                    });
                    hammer.on('panright', function(ev) {
                        console.log('right ' + card.id);
                    });*/
                });

            })
        </script>
    </head>
    <body>
        <div id="horizontal-wrap">
            <div id="page-wrap">
                <div class="container-fluid">
                    <button id="test-button" type="button" class="btn btn-default">Default</button>
                    <div id="hand">
                        <div class="card" id="1">
                        </div>
                        <div class="card" id="2">
                        </div>
                        <div class="card" id="3">
                        </div>
                        <div class="card" id="4">
                        </div>
                        <div class="card" id="5">
                        </div>
                        <div class="card" id="6">
                        </div>
                        <div class="card" id="7">
                        </div>
                        <div class="card" id="8">
                        </div>
                        <div class="card" id="9">
                        </div>
                        <div class="card" id="10">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>